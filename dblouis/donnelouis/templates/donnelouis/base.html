{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}L'Air du VolÂ®{% endblock %}</title>
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <link rel="stylesheet" href="{% static 'css/chat.css' %}">
  <link rel="stylesheet" href="{% static 'css/ads.css' %}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="{% static 'images/logo.png' %}" type="image/png">
  {% block extra_css %}{% endblock %}
</head>
<body>
  <!-- Barre du haut -->
  <header class="topbar">
    <div class="logo-site">
      <button id="toggle-sidebar" class="sidebar-toggle">â˜°</button>
      <img src="{% static 'images/logo.png' %}" alt="Logo" class="logo-img">
      <span class="site-name">L'Air du volÂ®</span>
    </div>
    <button id="toggle-theme" class="theme-toggle">
      <span class="theme-icon">ğŸŒ™</span>
      <span class="theme-text">Mode Sombre</span>
    </button>
  </header>

  <!-- Menu latÃ©ral -->
  <nav class="sidebar">
    <ul class="menu">
      <li><a href="{% url 'index' %}">Accueil ğŸ </a></li>
      <li class="has-submenu">
        <a href="#">Exploration ğŸ“š </a>
        <ul class="sous-menu">
          <li><a href="{% url 'liste_articles' %}">Articles ğŸ“°</a></li>
          <li><a href="{% url 'liste_medias' %}">MÃ©dias ğŸ–¥ï¸</a></li>
          <li><a href="{% url 'liste_liens' %}">Liens ğŸ”—</a></li>
        </ul>
      </li>
      <li class="has-submenu">
        <a href="#">CommunautÃ© ğŸ‘¥</a>
        <ul class="sous-menu">
          <li><a href="{% url 'contact' %}">Nous contacter ğŸ“</a></li>
          <li><a href="{% url 'forum' %}">Forum ğŸ’¬</a></li>
        </ul>
          {% if user.is_authenticated %}
            <li class="sous-menu-title">Ajouter du contenu:</li>
            <li><a href="{% url 'ajouter_article' %}">â• Article</a></li>
            <li><a href="{% url 'ajouter_media' %}">â• MÃ©dia</a></li>
            <li><a href="{% url 'ajouter_lien' %}">â• Lien</a></li>
          {% endif %}
      </li>
    <li><a href="#footer-cgu">CGU âš ï¸</a></li>
    </ul>
    
    <!-- Authentification -->
    <div class="sidebar-auth">
      {% if user.is_authenticated %}
        <div class="auth-user">
          <p>ğŸ‘¤ {{ user.username }}</p>
          <a href="{% url 'logout' %}" class="btn-logout">Se dÃ©connecter</a>
        </div>
      {% else %}
        <a href="{% url 'login' %}" class="btn-auth btn-login">ğŸ” Se connecter</a>
        <a href="{% url 'signup' %}" class="btn-auth btn-signup">âœï¸ S'inscrire</a>
      {% endif %}
    </div>
  </nav>

  <!-- Contenu principal -->
  <main class="main-content">
    <!-- Bandeau d'avertissement pour utilisateurs non connectÃ©s -->
    {% if not user.is_authenticated %}
      <div class="premium-banner">
        <div class="premium-banner-content">
          <div class="premium-banner-text">
            <h3><i class="fas fa-star"></i> AccÃ¨s Premium - 100% Gratuit</h3>
            <p>
              CrÃ©ez un compte gratuitement pour :
              <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                <li><strong>Lire autant d'articles que vous le souhaitez</strong> (actuellement limitÃ© Ã  10 par jour)</li>
                <li><strong>ZÃ©ro publicitÃ©</strong> - navigation fluide et sans interruption</li>
                <li><strong>CrÃ©er vos propres articles et contenus</strong></li>
                <li><strong>Participer Ã  la communautÃ©</strong> - forum sans restriction</li>
              </ul>
            </p>
          </div>
          <div class="premium-banner-actions">
            <a href="{% url 'signup' %}" class="btn-premium-signup">
              <i class="fas fa-user-plus"></i> S'inscrire Gratuitement
            </a>
            <a href="{% url 'login' %}" class="btn-premium-login">
              <i class="fas fa-sign-in-alt"></i> Se Connecter
            </a>
          </div>
          {% if request.article_remaining is not None %}
            <div class="premium-banner-counter">
              <i class="fas fa-newspaper"></i>
              Articles restants aujourd'hui: <strong>{{ request.article_remaining }}/10</strong>
            </div>
          {% endif %}
        </div>
      </div>
    {% endif %}

    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
  <footer class="footer" id="footer-cgu">
    <div class="footer-content">
      <h3>Conditions GÃ©nÃ©rales d'Utilisation</h3>
      <p>En accÃ©dant au site <strong>L'Air du vol</strong>, vous acceptez nos conditions gÃ©nÃ©rales d'utilisation. Toute reproduction ou diffusion du contenu est interdite sans autorisation.</p>
      <p><strong>&copy; 2025 - L'Air du vol. Tous droits rÃ©servÃ©s.</strong></p>
      <p>"Je suis Louis Rivoal, Ã©lÃ¨ve de 3áµ‰. Jâ€™ai crÃ©Ã© ce site , mais il peut contenir des bugs. Nâ€™hÃ©sitez pas Ã  me contacter ! Merci d'avance !" </p>
    </div>
  </footer>

  <!-- Bouton Assistant IA -->
  <button id="ai-chat-btn" title="Ouvrir l'assistant IA">ğŸ’¬</button>

  <!-- Modale Chat IA -->
  <div id="ai-chat-modal">
    <div class="ai-chat-header">
      <div>
        <h3>Assistant IA L'Air du Vol</h3>
        <div class="ai-chat-header-subtitle">âš¡ RÃ©ponses instantanÃ©es</div>
      </div>
      <button id="close-ai-chat" title="Fermer le chat">&times;</button>
    </div>
    <div class="ai-chat-messages" id="ai-chat-messages">
      <div class="ai-message ai system">
        Bienvenue! ğŸ‘‹ Je suis l'assistant IA de L'Air du Vol. Comment puis-je vous aider?
      </div>
    </div>
    <div class="typing-indicator" id="typing-indicator">
      <div class="typing-dots"><span></span><span></span><span></span></div>
    </div>
    <div class="ai-chat-input">
      <textarea id="ai-input" placeholder="Posez votre question..." rows="1"></textarea>
      <button id="ai-send-btn" title="Envoyer (Ctrl+EntrÃ©e)"></button>
    </div>
  </div>

  <script src="{% static 'js/dark-mode.js' %}"></script>
  <script src="{% static 'js/main.js' %}"></script>
  <script src="{% static 'js/ai-chat.js' %}"></script>
  <script src="{% static 'js/ads.js' %}"></script>
  {% block extra_js %}{% endblock %}
</body>
</html>